<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Client</title>
</head>
<body>
    <pre id="output"></pre>
    <button onclick="login()">Login</button>

    <pre id="logs"></pre>

    <script src="/index.js"></script>

    <script>
        window.client = new Serpent('http://localhost:3000', {
            socket: true,
            debug: true,
            refresh: true
        });

        const {d, debugPanel} = client._utils;

        client.ready(async () => {
            window.login = async () => {
                if (localStorage.getItem('token')) {
                    return d('Already logged in');
                }

                d('Logging in.');
                const {errors, data} = await client._auth.login({
                    provider: 'local',
                    email: 'me@me.com',
                    password: 'password'
                });

                if (errors) {
                    return d('Error', errors);
                }

                d('Logged in', data);
            };

            login();
        });

        debugPanel('#logs');


    </script>
</body>
</html>